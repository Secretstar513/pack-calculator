<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Order-Pack Calculator</title>
  <style>
    body{font-family:sans-serif;max-width:640px;margin:auto;padding:24px}
    h1{margin-top:0}
    label{display:flex;gap:8px;align-items:center;margin-bottom:8px}
    input[type=number]{width:100%;padding:4px}
    button{background:#28a745;color:#fff;border:none;padding:8px 16px;
           border-radius:4px;font-size:14px;cursor:pointer}
    table{border-collapse:collapse;width:100%;margin-top:16px}
    th,td{border:1px solid #999;padding:6px;text-align:center}
    #msg{color:#c00;margin-top:8px}
  </style>
</head>
<body>

<h1>Order-Pack Calculator</h1>

<label>
  Items to order:
  <input id="items" type="number" min="1" placeholder="e.g. 263">
</label>
<button onclick="calculate()">Calculate</button>
<div id="msg"></div>

<table id="result" style="display:none">
  <thead><tr><th>Pack size</th><th>Quantity</th></tr></thead>
  <tbody></tbody>
</table>

<script>
async function calculate() {
  const items = +document.getElementById('items').value;
  if (items <= 0) { showMsg('Enter a positive number'); return; }

  try {
    const r = await fetch('/api/calculate', {          // <— Vercel function path
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({items})
    });
    if (!r.ok) { showMsg(await r.text()); return; }

    const {result} = await r.json();
    renderTable(result);
    showMsg('');
  } catch (e) {
    showMsg('Network error – try again');
  }
}

function renderTable(obj) {
  const tbody = document.querySelector('#result tbody');
  tbody.innerHTML = '';
  Object.entries(obj).sort((a,b)=>b[0]-a[0])  // bigger packs first
        .forEach(([pack, qty]) => {
          tbody.innerHTML += `<tr><td>${pack}</td><td>${qty}</td></tr>`;
        });
  document.getElementById('result').style.display = '';
}

function showMsg(txt){ document.getElementById('msg').textContent = txt; }
</script>

</body>
</html>
